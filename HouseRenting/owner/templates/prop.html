{%extends 'home.html' %} {% load static %} {% block content %}
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600&family=Inter:wght@700;800&display=swap"
rel="stylesheet">

<!-- Icon Font Stylesheet -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
crossorigin="anonymous"></script>
  <!-- Moment.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.23.0/moment.min.js"
      integrity="sha256-VBLiveTKyUZMEzJd6z2mhfxIqz3ZATCuVMawPZGzIfA=" crossorigin="anonymous"></script>
      <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">

      <!-- Template Stylesheet -->
      <link href="{% static 'css/style.css' %}" rel="stylesheet">
      
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
  <!-- Tempus Dominus Bootstrap 4 -->
  <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/css/tempusdominus-bootstrap-4.min.css"
      integrity="sha256-XPTBwC3SBoWHSmKasAk01c08M6sIA5gF5+sRxqak2Qs=" crossorigin="anonymous" />
  <script
      src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/js/tempusdominus-bootstrap-4.min.js"
      integrity="sha256-z0oKYg6xiLq3yJGsp/LsY9XykbweQlHl42jHv2XTBz4=" crossorigin="anonymous"></script>
  <title>Property Page</title>
  <link rel="shortcut icon" type="image/png" href="{% static 'logo.png'%}" />

</head>
<style>
  .det-div {
    height: 90%;
    width: 90%;
    padding-top: 4rem;
    border-radius: 10px;
    background-color: white;
  }

  .carousel {
    margin: 4rem 0rem 0rem 0rem;
    width: 600px;
    height: 450px;
  }

  .bar-5 {
    width: 0%;
    height: 6px;
    background-color: #04aa6d;
  }

  .bar-container {
    width: 100%;
    background-color: #f1f1f1;
    text-align: center;
    color: white;
  }
  .form_css {
    border-radius: 8px;
    margin: 9%;
    width: 80%;
  }

  .bar-4 {
    width: 0%;
    height: 6px;
    background-color: #2196f3;
  }

  .bar-3 {
    width: 0%;
    height: 6px;
    background-color: #00bcd4;
  }

  .bar-2 {
    width: 0%;
    height: 6px;
    background-color: #ff9800;
  }

  .bar-1 {
    width: 0%;
    height: 6px;
    background-color: #f44336;
  }

  .img {
    width: 580px;
    height: 500px;
    border-radius: 10px;
    border: 2px solid grey;
  }
  .details {
    background-color: rgba(154, 199, 233, 0.296);
    border-radius: 5px;
    border: 1px solid lightgrey;
    box-shadow: 10px 10px 10px lightgrey;
    margin-top: 5rem;
    margin-right: 1rem;
  }
  .p {
    font-size: 15px;
    padding: 1px;
    font-family: bold;
  }
  .review {
    align-items: center;
    margin-left: 3%;
  }
  label {
    font-weight: bold;
  }

  form {
    width: 90%;
    margin: 10px;
    padding: 10px;
  }
  .slider {
    padding-top: 1rem;
  }
 .card-review{
  padding-left: 14px;
  background-color: white;
  box-shadow: 0 0 15px rgba(0,0,0,0.4);
  width:22rem;
  max-height: 15rem;
  overflow-y: scroll;
  border-radius: 15px;
  margin: 1rem 1rem 0.5rem 0;
 }
 .card-review::-webkit-scrollbar{
  display: none;
 }
  .ratings i {
    color: rgb(246, 179, 10);
  }
  div.stars {
    width: 100px;
    display: inline-block;
  }

  input.star {
    display: none;
  }
  label.star {
    float: right;

    padding: 3px;

    font-size: 25px;

    color: #fd4;

    transition: all 0.2s;
    cursor: pointer !important;
  }

  input.star:checked ~ label.star:before {
    content: "\f005";

    color: #fd4;

    transition: all 0.25s;
  }

  input.star-5:checked ~ label.star:before {
    color: #fe7;

    text-shadow: 0 0 20px #952;
  }

  input.star-1:checked ~ label.star:before {
    color: #f62;
  }

  label.star:hover {
    transform: rotate(-15deg) scale(1.3);
  }

  label.star:before {
    content: "\f006";

    font-family: FontAwesome;
  }

  .status{
    width: 60%;
    margin-top: 1rem;
    border-radius: 8px;
    margin-left: 26%;
    align-items: center;
    align-items: center;
    width: max-content;
    background-color: #f0b5b9;
  }
  .status-title{
    text-align:center;
    font-size: 30px;
    font-weight: bold;
  }

  @media (max-width: 1200px) {
    .slider {
      margin: 2rem 3% 0 3%;
    }
    .details {
      margin: 10%;
      max-width: 70%;
    }
    .review {
    align-items: center;
    margin: 1%;
    display: flex;
    justify-content: center;
  }
    .card-review{
      width: 70%;
    }
    .carousel {
      display: flex;
      width: 550px;
      height: 450px;
      justify-content: center;
      align-items: center;
    }

    .img {
      width: 100%;
      height: 500px;
    }
  }
  @media (max-width: 600px) {

    .carousel {
      display: flex;
      margin: 0%;
      width: 100%;
      height: 450px;
      justify-content: center;
      align-items: center;
    }
    .review {
    align-items: center;
    margin: 1%;
    display: flex;
    justify-content: center;
  }

    .img {
      width: 95%;
      height: 500px;
    }
    .card-review{
      width: 70%;
    }
    .det-div {
      margin: 5rem 0 0 0;
      min-width: 100%;
    }
    .details {
      max-width: 80%;
      margin: 0 1rem 0 1rem;
    }
    .slider {
      width: 100%;
      margin: 0%;
    }
  }
  
  
</style>
<div class="container-fluid det-div">
  <div class="row">
    <div class="col-xl-6 slider">
      <div
        id="carouselExampleIndicators"
        class="carousel slide"
        data-ride="carousel"
      >
        <ol class="carousel-indicators">
          <li
            data-target="#carouselExampleIndicators"
            data-slide-to="0"
            class="active"
          ></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner" style="margin-left: 3rem;">
          <div class="carousel-item active">
            <img
              class="img"
              src="{{property.myImage.url}}"
              class="d-block w-100"
              alt="..."
              style="height: 400px"
            />
          </div>
          {% for image in images %}
          <div class="carousel-item">
            <img
              class="img"
              src="{{image.file.url}}"
              alt="Image from DB"
              style="height: 400px"
            />
          </div>
          {% endfor %}
        </div>
        <a
          class="carousel-control-prev"
          href="#carouselExampleIndicators"
          role="button"
          data-slide="prev"
          style="padding-left: 10%;"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a
          class="carousel-control-next"
          href="#carouselExampleIndicators"
          role="button"
          data-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>

      <div class="col-md-1"></div>

      <div
        class="col-md-8 form_css"
        style="background-color: rgb(241, 204, 204);"
      >
      {% if review_count == 0 %}
          <h3>No Reviews Available</h3>
      {% endif %}
        <div class="container mb-6">
          <a href="#load-More" id="load-more" style="margin-left: 5rem;"></a>
          <div class="row">
            <div class="col-lg-4">
              
              <div style="font-size: 75px">{{avg_rating|floatformat:1}}</div>
              <p class="text-secondary">OverallRating</p>
            </div>
            <div class="col-lg-8" style="align-items: center;">
              <div class="row">
                <div class="col-lg-12">
                  <div class="row d-flex align-items-center text-center">
                    <div
                      class="col-lg-2 col-md-2 col-sm-2 col-2"
                      style="padding-right: 0"
                    >
                      5
                      <span
                        class="fa fa-star checked text-warning mt-1"
                        style="position: absolute"
                      ></span>
                    </div>
                    <div
                      class="col-lg-4 col-md-4 col-sm-4 col-4"
                      style="padding-left: 0; padding-right: 0"
                    >
                      <div class="bar-container">
                        <div class="bar-5"></div>
                      </div>
                    </div>
                    <div
                      class="col-lg-1 col-md-2 col-sm-2 col-2"
                      style="padding-left: 0"
                    >
                    {{five_star}}
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-12">
                  <div class="row d-flex align-items-center text-center">
                    <div
                      class="col-lg-2 col-md-2 col-sm-2 col-2"
                      style="padding-right: 0"
                    >
                      4
                      <span
                        class="fa fa-star checked text-warning mt-1"
                        style="position: absolute"
                      ></span>
                    </div>
                    <div
                      class="col-lg-4 col-md-4 col-sm-4 col-4"
                      style="padding-left: 0; padding-right: 0"
                    >
                      <div class="bar-container">
                        <div class="bar-4"></div>
                      </div>
                    </div>
                    <div
                      class="col-lg-1 col-md-2 col-sm-2 col-2"
                      style="padding-left: 0"
                    >
                    {{four_star}}
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-12">
                  <div class="row d-flex align-items-center text-center">
                    <div
                      class="col-lg-2 col-md-2 col-sm-2 col-2"
                      style="padding-right: 0"
                    >
                      3
                      <span
                        class="fa fa-star checked text-warning mt-1"
                        style="position: absolute"
                      ></span>
                    </div>
                    <div
                      class="col-lg-4 col-md-4 col-sm-4 col-4"
                      style="padding-left: 0; padding-right: 0"
                    >
                      <div class="bar-container">
                        <div class="bar-3"></div>
                      </div>
                    </div>
                    <div
                      class="col-lg-1 col-md-2 col-sm-2 col-2"
                      style="padding-left: 0"
                    >
                    {{three_star}}
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-12">
                  <div class="row d-flex align-items-center text-center">
                    <div
                      class="col-lg-2 col-md-2 col-sm-2 col-2"
                      style="padding-right: 0"
                    >
                      2
                      <span
                        class="fa fa-star checked text-warning mt-1"
                        style="position: absolute"
                      ></span>
                    </div>
                    <div
                      class="col-lg-4 col-md-4 col-sm-4 col-4"
                      style="padding-left: 0; padding-right: 0"
                    >
                      <div class="bar-container">
                        <div class="bar-2"></div>
                      </div>
                    </div>
                    <div
                      class="col-lg-1 col-md-2 col-sm-2 col-2"
                      style="padding-left: 0"
                    >
                    {{two_star}}
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-12">
                  <div class="row d-flex align-items-center text-center">
                    <div
                      class="col-lg-2 col-md-2 col-sm-2 col-2"
                      style="padding-right: 0"
                    >
                      1
                      <span
                        class="fa fa-star checked text-warning mt-1"
                        style="position: absolute"
                      ></span>
                    </div>
                    <div
                      class="col-lg-4 col-md-4 col-sm-4 col-4"
                      style="padding-left: 0; padding-right: 0"
                    >
                      <div class="bar-container">
                        <div class="bar-1"></div>
                      </div>
                    </div>
                    <div
                      class="col-lg-1 col-md-2 col-sm-2 col-2"
                      style="padding-left: 0"
                    >
                    {{one_star}}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col review">
        <div class="col-lg-6">
          {%for review in reviews %}
          <div class="col-md-12 mb-2">
              <div class="card-review p-2  px-4 mb-2 ">
                  <div class="user-content">

                      <h5 class="mb-3 mt-1 ratings">



                          <i class="fa fa-star text-warning me-2">{{review.rating}}</i>

                          {{ review.user_id.first_name }} {{ review.user_id.last_name}}
                      </h5>

                      <p>{{ review.review }}
                      </p>

                  </div>

              </div>
          </div>
          {% endfor %}
          {%for review in remaining_reviews %}
          <div class="col-md-12 mb-2 post hidden">
              <div class="card-review p-2 ">
                  <div class="user-content">

                      <h5 class="mb-3 mt-1 ratings">



                          <i class="fa fa-star text-warning me-2">{{review.rating}}</i>

                         {{review.user_id.first_name}} {{ review.user_id.last_name}}
                      </h5>

                      <p>{{ review.review }}
                      </p>

                  </div>



              </div>
          </div>
          {% endfor %}




      </div>
      </div>
    </div>
      <div class="col-xl-5 col-sm-12 details">
        <h3 style="text-align: center; font-family: cursive">
          <b>{{property.property_type}}</b>
        </h3>
        <div>
          {% if error%}
          {% for i in Errors %}
          <div class="alert alert-danger alert-dismissible show " role="alert">
              <strong>{{i}}</strong>
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          {%endfor%}
          {% endif %}
      </div>
        <form action="" method="post" enctype="multipart/form-data">
          {%csrf_token%}
          <div class="row mb-3">
            <label for="flat_name" class="col-sm-4 col-form-label"
              >Property Name:
            </label>
            <div class="col-sm-8">
              <input
                type="text"
                class="form-control"
                id="flat_name"
                name="flat_name"
                value="{{property.flat_name}}"
              />
            </div>
          </div>
          <div class="row mb-3">
            <label for="city" class="col-sm-4 col-form-label">Location: </label>
            <div class="col-sm-8">
              <input
                type="text"
                class="form-control"
                id="city"
                name="city"
                value="{{property.city}}"
              />
            </div>
          </div>
          <div class="row mb-3">
            <label for="flatt" class="col-sm-4 col-form-label">BHK: </label>
            <div class="col-sm-8">
              <input
                type="number"
                class="form-control"
                id="flatt"
                name="flatt"
                value="{{property.flat_type}}"
              />
            </div>
          </div>

          {% if choice %}
          <div class="u-type">
            <label for="type" style="margin-right: 1rem"
              >Renting choice:
            </label>
            &nbsp &nbsp
            <label class="radio-inline" style="margin-right: 1rem">
              <input type="radio" name="type" value="Full House" checked />
              &nbsp Full House
            </label>

            <label class="radio-inline">
              <input type="radio" name="type" value="Sharing basis" /> &nbsp
              Sharing Basis
            </label>
          </div>
          {% else %}
          <div class="u-type">
            <label for="type" style="margin-right: 1rem"
              ><b>Renting choice: </b></label
            >
            <label class="radio-inline" style="margin-right: 1rem">
              <input type="radio" name="type" value="Full House" /> &nbsp Full
              House
            </label>

            <label class="radio-inline">
              <input type="radio" name="type" value="Sharing basis" checked />
              &nbsp Sharing Basis
            </label>
          </div>
          {% endif %}

          <div class="row mb-3">
            <label for="ramount" class="col-sm-4 col-form-label"
              >Rent Amount: (Rupees)
            </label>
            <div class="col-sm-8">
              <input
                type="number"
                class="form-control"
                id="ramount"
                name="ramount"
                value="{{property.ramount}}"
              />
            </div>
          </div>

          <div class="row mb-3">
            <label for="bond" class="col-sm-4 col-form-label"
              >Bond (in months):
            </label>
            <div class="col-sm-8">
              <input
                type="number"
                class="form-control"
                id="bond"
                name="bond"
                value="{{property.bond}}"
              />
            </div>
          </div>
          {% if furnish %}
            <div class="u-type">
              <label for="furnished" style="margin-right: 0rem"
                >Furnishing Status:</label
              >
              <label class="radio-inline">
                <input type="radio" name="furnished" value="Furnished" checked />
                &nbsp Furnished
              </label>

              <label class="radio-inline" style="margin-left: 0.5rem;">
                <input type="radio" name="furnished" value="UnFurnished" /> &nbsp
                UnFurnished
              </label>
            </div>

          {% else %}
          <div class="u-type">
            <label for="furnished" style="margin-right: 0rem"
              >Furnishing Status:</label
            >
            <label class="radio-inline">
              <input type="radio" name="furnished" value="Furnished" />
              &nbsp Furnished
            </label>

            <label class="radio-inline" style="margin-left: 0.5rem;">
              <input type="radio" name="furnished" value="UnFurnished" checked /> &nbsp
              UnFurnished
            </label>
          </div>

          {% endif %}

          <div class="row mb-3">
            <label for="area" class="col-sm-4 col-form-label">Area: </label>
            <div class="col-sm-8">
              <input
                type="number"
                class="form-control"
                id="area"
                name="area"
                value="{{property.area}}"
              />
            </div>
          </div>
          <div class="row mb-3">
            <label for="tflat" class="col-sm-4 col-form-label"
              >Total Number of Flats:
            </label>
            <div class="col-sm-8">
              <input
                type="number"
                class="form-control"
                id="tflat"
                name="tflat"
                value="{{property.total_flats}}"
              />
            </div>
          </div>
          <div class="row mb-3">
            <label for="ftotal" class="col-sm-4 col-form-label"
              >Number of Floors:
            </label>
            <div class="col-sm-8">
              <input
                type="number"
                class="form-control"
                id="ftotal"
                name="ftotal"
                value="{{property.totfloors}}"
              />
            </div>
          </div>

          <div class="form-group">
            <label for="park" default="{{property.parking}}"
              >Parking Facility:</label
            >
            {% if property.parking == "Yes" %}
              <select class="form-control" id="park" name="park" value="{{property.parking}}">
                <option selected>Yes</option>
                <option>No</option>
              </select>
            {% else %}
              <select class="form-control" id="park" name="park" value="{{property.parking}}">
                <option>Yes</option>
                <option selected>No</option>
              </select>
            {% endif %}

          </div>
          <div class="form-group">
            <label for="address">Address:</label>
            <textarea class="form-control" id="address" name="address" rows="3">
{{property.address}}</textarea
            >
          </div>

          <div class="u-type">
            <label for="status" style="margin-right: 1rem">Status: </label>

            <label class="radio-inline" style="margin-right: 1rem">
              <input type="radio" name="status" value="Available" checked />
              &nbsp Available
            </label>

            <label class="radio-inline">
              <input type="radio" name="status" value="Occupied" /> &nbsp
              Occupied
            </label>
          </div>
          <div class="input-group date cls1 " id="datetimepicker1" data-target-input="nearest"
                    style="color: #212529; font-size: 20px; font-weight: 400; margin-top: 0.5rem; margin-bottom: 0.5rem;">
                    <label for="date">Available From: &nbsp</label>
                    <input type="text" class="form-control datetimepicker-input" name="date" id="date"
                        data-target="#datetimepicker1" value="{{property.availability_date}}" />
                    <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                    </div>
          </div>
          <div class="mb-3">
            <label for="formFileMultiple" class="form-label"
              >Add more Images:</label
            >
            <input
              class="form-control"
              type="file"
              style="padding: 6px;"
              id="formFileMultiple"
              name="imgs"
              accept="image/png, image/gif, image/jpeg"
              multiple
            />
          </div>

          <div class="form-submit-btn text-center">
            <button
              type="submit"
              class="btn btn-success"
              style="margin: 2px auto; display: block"
            >
              Modify
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
    var loadMoreBtn = document.getElementById("load-more");
    var hiddenPosts = document.querySelectorAll(".post.hidden");
    var numHiddenPosts = hiddenPosts.length;
    var numPostsToShow = numHiddenPosts; // Change this to show more or fewer posts at a time

    loadMoreBtn.addEventListener("click", function (e) {
      e.preventDefault();
      if (numHiddenPosts > 0) {
        var numToShow = Math.min(numPostsToShow, numHiddenPosts);
        for (var i = 0; i < numToShow; i++) {
          hiddenPosts[i].classList.remove("hidden");
        }
        numHiddenPosts -= numToShow;
      }
      if (numHiddenPosts === 0) {
        loadMoreBtn.style.display = "none";
      }
    });

    var value = 0;

    $(".starimp").click(function () {
      var str = $(this).attr("value");
      value = parseInt(str);
    });

    $("#submit").click(function () {
      var id = $("#submit").attr("val");

      var error = "";
      if (value == 0) {
        error = "Please give some rating...";
      }
      var review = $("#review").val();
      if (review.length == 0) error = error + "please give some review";
      if (review.length > 500)
        error =
          error +
          "Review must be less than 500 characters and you need to remove " +
          (review.length - 500) +
          "characters";

      $("#hidden").text(error);
      $("#hidden").show();

      if (error.length == 0) {
        var data = {
          review: review,
          rating: value,
          id: id,
        };

        $.ajax({
          type: "POST",
          url: "/rentee/postreview/",
          data: JSON.stringify(data),
          success: function (response) {
            alert(response.status);
            $("#hidden").css("color", "green");
            $("#hidden").text(response.status);
            $("#hidden").show();
          },
          contentType: "application/json",
        });
      }
    });
    const bar5 = document.querySelector('.bar-5');
    bar5.style.width = '{{percentage_5_star}}%';
    const bar4 = document.querySelector('.bar-4');
    bar4.style.width = '{{percentage_4_star}}%';
    const bar3 = document.querySelector('.bar-3');
    bar3.style.width = '{{percentage_3_star}}%';
    const bar2 = document.querySelector('.bar-2');
    bar2.style.width = '{{percentage_2_star}}%';
    const bar1 = document.querySelector('.bar-1');
    bar1.style.width = '{{percentage_1_star}}%';
  </script>
  <script>
    $(function () {
        $("#datetimepicker1").datetimepicker({format:'DD/MM/YYYY'});
    });
</script>
  <!-- Back to Top -->
  <a href="#" class="btn btn-lg btn-danger btn-lg-square back-to-top"
    ><i class="bi bi-arrow-up"></i
  ></a>
</div>

<!-- JavaScript Libraries -->

<!-- Template Javascript -->

{% endblock %}
